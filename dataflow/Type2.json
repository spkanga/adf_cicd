{
	"name": "Type2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "Employee2Tbl",
						"type": "DatasetReference"
					},
					"name": "StgSource"
				},
				{
					"dataset": {
						"referenceName": "DWType2Tb",
						"type": "DatasetReference"
					},
					"name": "DWHSource"
				},
				{
					"dataset": {
						"referenceName": "MaxVal",
						"type": "DatasetReference"
					},
					"name": "Offsetss"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DWType2Tb",
						"type": "DatasetReference"
					},
					"name": "TargetTable"
				}
			],
			"transformations": [
				{
					"name": "HashValueStream"
				},
				{
					"name": "JoinWithOffetStream"
				},
				{
					"name": "LkpSourceTargetStream"
				},
				{
					"name": "SurrogateKey"
				},
				{
					"name": "AddColumns"
				},
				{
					"name": "Insert"
				}
			],
			"script": "\n\nsource(output(\n\t\tBusinessEntityID as string,\n\t\tNationalIDNumber as string,\n\t\tLoginID as string,\n\t\tOrganizationNode as string,\n\t\tOrganizationLevel as string,\n\t\tJobTitle as string,\n\t\tBirthDate as string,\n\t\tMaritalStatus as string,\n\t\tGender as string,\n\t\tHireDate as string,\n\t\tSalariedFlag as string,\n\t\tVacationHours as string,\n\t\tSickLeaveHours as string,\n\t\tCurrentFlag as string,\n\t\trowguid as string,\n\t\tModifiedDate as string,\n\t\t{_inserted} as timestamp,\n\t\t{_lastUpdated} as timestamp,\n\t\tStgHash as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT * FROM [dbo].[employee2]',\n\tformat: 'query') ~> StgSource\nsource(output(\n\t\tdwh_EmployeeKey as integer,\n\t\tdwh_BusinessEntityID as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT [dwh_EmployeeKey]\\n      ,[dwh_BusinessEntityID]\\nFROM [dbo].[dimEmployee2]\\nWHERE [Current] = 1',\n\tformat: 'query') ~> DWHSource\nsource(output(\n\t\tOffsetss as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tquery: 'SELECT ISNULL(MAX([dwh_EmployeeKey]),1) Offsetss\\n\\nFROM [dbo].[dimEmployee2]',\n\tformat: 'query') ~> Offsetss\nStgSource derive(StgHash = sha2(256, LoginID + OrganizationNode + OrganizationLevel + JobTitle)) ~> HashValueStream\nHashValueStream, Offsetss join(1 == 1,\n\tjoinType:'cross',\n\tbroadcast: 'none')~> JoinWithOffetStream\nJoinWithOffetStream, DWHSource lookup(BusinessEntityID == dwh_BusinessEntityID,\n\tbroadcast: 'none')~> LkpSourceTargetStream\nLkpSourceTargetStream keyGenerate(output(EmployeeKey as long),\n\tstartAt: 1L) ~> SurrogateKey\nSurrogateKey derive(EmployeeKey = EmployeeKey + Offsetss,\n\t\tDWH_Current = toBoolean('1'),\n\t\tEffectiveStartDateTime = currentUTC(),\n\t\tEffectiveEndDateTime = toDate('2100-01-01')) ~> AddColumns\nAddColumns alterRow(insertIf(1 == 1)) ~> Insert\nInsert sink(input(\n\t\tdwh_EmployeeKey as integer,\n\t\tdwh_BusinessEntityID as string,\n\t\tdwh_NationalIDNumber as string,\n\t\tdwh_LoginID as string,\n\t\tdwh_OrganizationNode as string,\n\t\tdwh_OrganizationLevel as string,\n\t\tdwh_JobTitle as string,\n\t\tdwh_BirthDate as string,\n\t\tdwh_inserted as string,\n\t\tdwh_lastUpdated as timestamp,\n\t\tdwh_HashValue as string,\n\t\tCurrent as integer,\n\t\tEffectiveStartDateTime as timestamp,\n\t\tEffectiveEndDateTime as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tmapColumn(\n\t\tdwh_EmployeeKey = EmployeeKey,\n\t\tdwh_BusinessEntityID = BusinessEntityID,\n\t\tdwh_NationalIDNumber = NationalIDNumber,\n\t\tdwh_LoginID = LoginID,\n\t\tdwh_OrganizationNode = OrganizationNode,\n\t\tdwh_OrganizationLevel = OrganizationLevel,\n\t\tdwh_JobTitle = JobTitle,\n\t\tdwh_BirthDate = BirthDate,\n\t\tCurrent = DWH_Current,\n\t\tEffectiveStartDateTime,\n\t\tEffectiveEndDateTime\n\t)) ~> TargetTable"
		}
	}
}